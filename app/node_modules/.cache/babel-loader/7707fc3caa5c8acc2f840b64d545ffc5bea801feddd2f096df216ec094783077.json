{"ast":null,"code":"import { useRef as e, useCallback as r, useEffect as n, useState as t } from \"react\";\nimport { jsx as o } from \"react/jsx-runtime\";\nfunction i(t) {\n  var o = t.redirectUri,\n    i = t.clientId,\n    c = t.onSuccess,\n    a = t.onError,\n    s = t.scope,\n    d = void 0 === s ? \"r_emailaddress\" : s,\n    u = t.state,\n    l = void 0 === u ? \"\" : u,\n    w = t.closePopupMessage,\n    p = void 0 === w ? \"User closed the popup\" : w,\n    g = e(null),\n    v = e(null),\n    f = r(function (e) {\n      var r = localStorage.getItem(\"linkedin_oauth2_state\");\n      if (e.origin === window.location.origin) if (e.data.errorMessage && \"Linked In\" === e.data.from) {\n        if (e.data.state !== r) return void (g.current && g.current.close());\n        a && a(e.data), g.current && g.current.close();\n      } else if (e.data.code && \"Linked In\" === e.data.from) {\n        if (e.data.state !== r) return void (g.current && g.current.close());\n        c && c(e.data.code), g.current && g.current.close();\n      }\n    }, [a, c]);\n  n(function () {\n    return function () {\n      window.removeEventListener(\"message\", f, !1), g.current && (g.current.close(), g.current = null), v.current && (window.clearInterval(v.current), v.current = null);\n    };\n  }, [f]), n(function () {\n    return window.addEventListener(\"message\", f, !1), function () {\n      window.removeEventListener(\"message\", f, !1);\n    };\n  }, [f]);\n  var h = function () {\n    var e = \"&scope=\" + encodeURI(d),\n      r = l || function (e) {\n        void 0 === e && (e = 20);\n        for (var r = \"\", n = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", t = n.length, o = 0; o < e; o++) r += n.charAt(Math.floor(Math.random() * t));\n        return r;\n      }();\n    return localStorage.setItem(\"linkedin_oauth2_state\", r), \"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=\" + i + \"&redirect_uri=\" + o + e + \"&state=\" + r;\n  };\n  return {\n    linkedInLogin: function () {\n      var e;\n      null === (e = g.current) || void 0 === e || e.close(), g.current = window.open(h(), \"_blank\", function (e) {\n        var r = e.width,\n          n = void 0 === r ? 600 : r,\n          t = e.height,\n          o = void 0 === t ? 600 : t;\n        return \"left=\" + (screen.width / 2 - n / 2) + \",top=\" + (screen.height / 2 - o / 2) + \",width=\" + n + \",height=\" + o;\n      }({\n        width: 600,\n        height: 600\n      })), v.current && (window.clearInterval(v.current), v.current = null), v.current = window.setInterval(function () {\n        try {\n          g.current && g.current.closed && (window.clearInterval(v.current), v.current = null, a && a({\n            error: \"user_closed_popup\",\n            errorMessage: p\n          }));\n        } catch (e) {\n          window.clearInterval(v.current), v.current = null;\n        }\n      }, 1e3);\n    }\n  };\n}\nfunction c(e) {\n  return (0, e.children)({\n    linkedInLogin: i({\n      redirectUri: e.redirectUri,\n      clientId: e.clientId,\n      onSuccess: e.onSuccess,\n      onError: e.onError,\n      state: e.state,\n      scope: e.scope,\n      closePopupMessage: e.closePopupMessage\n    }).linkedInLogin\n  });\n}\nfunction a() {\n  var e = t(\"\"),\n    r = e[0],\n    i = e[1];\n  return n(function () {\n    var e = function (e) {\n      for (var r = e.substring(1).split(\"&\"), n = {}, t = 0; t < r.length; t++) {\n        var o = r[t].split(\"=\");\n        o.length > 1 && (n[decodeURIComponent(o[0])] = decodeURIComponent(o[1]));\n      }\n      return n;\n    }(window.location.search);\n    if (e.state !== localStorage.getItem(\"linkedin_oauth2_state\")) i(\"State does not match\");else if (e.error) {\n      var r = e.error_description || \"Login failed. Please try again.\";\n      window.opener && window.opener.postMessage({\n        error: e.error,\n        state: e.state,\n        errorMessage: r,\n        from: \"Linked In\"\n      }, window.location.origin), \"user_cancelled_login\" === e.error && window.close();\n    }\n    e.code && window.opener && window.opener.postMessage({\n      code: e.code,\n      state: e.state,\n      from: \"Linked In\"\n    }, window.location.origin);\n  }, []), o(\"div\", {\n    children: r\n  }, void 0);\n}\nexport { c as LinkedIn, a as LinkedInCallback, i as useLinkedIn };","map":{"version":3,"mappings":"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","names":["useLinkedIn","_a","redirectUri","clientId","onSuccess","onError","_b","scope","_c","state","_d","closePopupMessage","popupRef","useRef","popUpIntervalRef","receiveMessage","useCallback","event","savedState","localStorage","getItem","origin","window","location","data","errorMessage","from","current","close","code","useEffect","removeEventListener","clearInterval","addEventListener","getUrl","scopeParam","encodeURI","generatedState","length","result","characters","charactersLength","i","charAt","Math","floor","random","generateRandomString","setItem","linkedInLogin","open","width","height","screen","getPopupPositionProperties","setInterval","closed","error","LinkedIn","children","LinkedInCallback","useState","setErrorMessage","params","search","vars","substring","split","parsed","pair","decodeURIComponent","parse","errorMessage_1","error_description","opener","postMessage","_jsx"],"sources":["/Users/anurodhyadav/resumebuilder/app/node_modules/react-linkedin-login-oauth2/src/useLinkedIn.tsx","/Users/anurodhyadav/resumebuilder/app/node_modules/react-linkedin-login-oauth2/src/utils.ts","/Users/anurodhyadav/resumebuilder/app/node_modules/react-linkedin-login-oauth2/src/LinkedIn.tsx","/Users/anurodhyadav/resumebuilder/app/node_modules/react-linkedin-login-oauth2/src/LinkedInCallback.tsx"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\nimport { useLinkedInType } from './types';\nimport { LINKEDIN_OAUTH2_STATE } from './utils';\n\nconst getPopupPositionProperties = ({ width = 600, height = 600 }) => {\n  const left = screen.width / 2 - width / 2;\n  const top = screen.height / 2 - height / 2;\n  return `left=${left},top=${top},width=${width},height=${height}`;\n};\n\nconst generateRandomString = (length = 20) => {\n  let result = '';\n  const characters =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  const charactersLength = characters.length;\n  for (let i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n};\n\nexport function useLinkedIn({\n  redirectUri,\n  clientId,\n  onSuccess,\n  onError,\n  scope = 'r_emailaddress',\n  state = '',\n  closePopupMessage = 'User closed the popup',\n}: useLinkedInType) {\n  const popupRef = useRef<Window>(null);\n  const popUpIntervalRef = useRef<number>(null);\n\n  const receiveMessage = useCallback(\n    (event: MessageEvent) => {\n      const savedState = localStorage.getItem(LINKEDIN_OAUTH2_STATE);\n      if (event.origin === window.location.origin) {\n        if (event.data.errorMessage && event.data.from === 'Linked In') {\n          // Prevent CSRF attack by testing state\n          if (event.data.state !== savedState) {\n            popupRef.current && popupRef.current.close();\n            return;\n          }\n          onError && onError(event.data);\n          popupRef.current && popupRef.current.close();\n        } else if (event.data.code && event.data.from === 'Linked In') {\n          // Prevent CSRF attack by testing state\n          if (event.data.state !== savedState) {\n            console.error('State does not match');\n            popupRef.current && popupRef.current.close();\n            return;\n          }\n          onSuccess && onSuccess(event.data.code);\n          popupRef.current && popupRef.current.close();\n        }\n      }\n    },\n    [onError, onSuccess],\n  );\n\n  useEffect(() => {\n    return () => {\n      window.removeEventListener('message', receiveMessage, false);\n\n      if (popupRef.current) {\n        popupRef.current.close();\n        popupRef.current = null;\n      }\n      if (popUpIntervalRef.current) {\n        window.clearInterval(popUpIntervalRef.current);\n        popUpIntervalRef.current = null;\n      }\n    };\n  }, [receiveMessage]);\n\n  useEffect(() => {\n    window.addEventListener('message', receiveMessage, false);\n    return () => {\n      window.removeEventListener('message', receiveMessage, false);\n    };\n  }, [receiveMessage]);\n\n  const getUrl = () => {\n    const scopeParam = `&scope=${encodeURI(scope)}`;\n    const generatedState = state || generateRandomString();\n    localStorage.setItem(LINKEDIN_OAUTH2_STATE, generatedState);\n    const linkedInAuthLink = `https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=${clientId}&redirect_uri=${redirectUri}${scopeParam}&state=${generatedState}`;\n    return linkedInAuthLink;\n  };\n\n  const linkedInLogin = () => {\n    popupRef.current?.close();\n    popupRef.current = window.open(\n      getUrl(),\n      '_blank',\n      getPopupPositionProperties({ width: 600, height: 600 }),\n    );\n\n    if (popUpIntervalRef.current) {\n      window.clearInterval(popUpIntervalRef.current);\n      popUpIntervalRef.current = null;\n    }\n    popUpIntervalRef.current = window.setInterval(() => {\n      try {\n        if (popupRef.current && popupRef.current.closed) {\n          window.clearInterval(popUpIntervalRef.current);\n          popUpIntervalRef.current = null;\n          if (onError) {\n            onError({\n              error: 'user_closed_popup',\n              errorMessage: closePopupMessage,\n            });\n          }\n        }\n      } catch (error) {\n        console.error(error);\n        window.clearInterval(popUpIntervalRef.current);\n        popUpIntervalRef.current = null;\n      }\n    }, 1000);\n  };\n\n  return {\n    linkedInLogin,\n  };\n}\n","export const LINKEDIN_OAUTH2_STATE = 'linkedin_oauth2_state';\n\nexport function parse(search) {\n  const query = search.substring(1);\n  const vars = query.split('&');\n  const parsed = {};\n  for (let i = 0; i < vars.length; i++) {\n    const pair = vars[i].split('=');\n    if (pair.length > 1) {\n      parsed[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n  }\n  return parsed;\n}\n","import { LinkedInType } from './types';\nimport { useLinkedIn } from './useLinkedIn';\n\nexport function LinkedIn({\n  children,\n  redirectUri,\n  clientId,\n  onSuccess,\n  onError,\n  state,\n  scope,\n  closePopupMessage,\n}: LinkedInType) {\n  const { linkedInLogin } = useLinkedIn({\n    redirectUri,\n    clientId,\n    onSuccess,\n    onError,\n    state,\n    scope,\n    closePopupMessage,\n  });\n  return children({ linkedInLogin });\n}\n","import { useEffect, useState } from 'react';\nimport { LINKEDIN_OAUTH2_STATE, parse } from './utils';\n\ntype ParamsType = {\n  state: string;\n  code?: string;\n  error?: string;\n  error_description?: string;\n};\n\nexport function LinkedInCallback() {\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  useEffect(() => {\n    const params = parse(window.location.search) as ParamsType;\n    if (params.state !== localStorage.getItem(LINKEDIN_OAUTH2_STATE)) {\n      setErrorMessage('State does not match');\n    } else if (params.error) {\n      const errorMessage =\n        params.error_description || 'Login failed. Please try again.';\n      window.opener &&\n        window.opener.postMessage(\n          {\n            error: params.error,\n            state: params.state,\n            errorMessage,\n            from: 'Linked In',\n          },\n          window.location.origin,\n        );\n      // Close tab if user cancelled login\n      if (params.error === 'user_cancelled_login') {\n        window.close();\n      }\n    }\n    if (params.code) {\n      window.opener &&\n        window.opener.postMessage(\n          { code: params.code, state: params.state, from: 'Linked In' },\n          window.location.origin,\n        );\n    }\n  }, []);\n\n  return <div>{errorMessage}</div>;\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}